<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>User Management | J2E Healthcare Trading</title>
    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <!-- Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet" />
    <style>
        :root {
            --j2e-red: #c82333; /* custom red */
            --j2e-light: #f8f9fa;
        }
        body {
            font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--j2e-light);
        }
        /* Navbar */
        .navbar {
            background-color: #ffffff !important;
            border-bottom: 1px solid #dee2e6;
        }
        .navbar-nav .nav-link {
            color: var(--j2e-red) !important;
            font-weight: 500;
        }
        .navbar-nav .nav-link.active {
            font-weight: 600;
            text-decoration: underline;
        }
        /* Summary cards */
        .summary-card {
            border-left: 4px solid var(--j2e-red);
        }
        /* Table avatars */
        .avatar {
            width: 40px;
            height: 40px;
            object-fit: cover;
            border-radius: 50%;
        }
        /* Red line below header */
        .section-divider {
            height: 3px;
            background-color: var(--j2e-red);
            opacity: 1;
        }
        /* Modal image preview */
        .image-preview {
            width: 150px;
            height: 150px;
            object-fit: cover;
            border-radius: 8px;
            border: 2px dashed #dee2e6;
        }
    </style>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg">
        <div class="container">
            <a class="navbar-brand d-flex align-items-center" href="#">
                <img src="signup-login images/J2E logo favicon.png" alt="Logo" class="me-2" width="50" height="50"/>
                <span class="fw-semibold">J2E Healthcare Trading</span>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            
            <div class="collapse navbar-collapse justify-content-center" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item mx-3"><a class="nav-link" href="#"><i class="bi bi-house-door me-1"></i> Home</a></li>
                    <li class="nav-item mx-3"><a class="nav-link" href="#"><i class="bi bi-box me-1"></i> Inventory</a></li>
                    <li class="nav-item mx-3"><a class="nav-link" href="#"><i class="bi bi-tags me-1"></i> Category</a></li>
                    <li class="nav-item mx-3"><a class="nav-link active" aria-current="page" href="#"><i class="bi bi-person me-1"></i> User</a></li>
                    <li class="nav-item mx-3"><a class="nav-link" href="#"><i class="bi bi-file-earmark-text me-1"></i> Invoice</a></li>
                </ul>
            </div>
            <div class="d-flex align-items-center">
                <img src="signup-login images/J2E logo favicon.png" class="rounded-circle" alt="User Icon" width="50" height="50"/>
                <span class="me-2">Username</span>
                <button class="btn btn-link p-0 ms-2" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                    <i class="bi bi-list fs-4 text-danger"></i>
                </button>
                <ul class="dropdown-menu dropdown-menu-end">
                    <li><a class="dropdown-item" href="#"><i class="bi bi-person me-2"></i>Profile</a></li>
                    <li><a class="dropdown-item" href="#"><i class="bi bi-gear me-2"></i>Settings</a></li>
                    <li><hr class="dropdown-divider"></li>
                    <li><a class="dropdown-item" href="#"><i class="bi bi-box-arrow-right me-2"></i>Logout</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <main class="container py-4">
        <!-- Header & Divider -->
        <h2 class="text-danger fw-semibold">User Management</h2>
        <div class="section-divider mb-4"></div>

        <!-- Action Bar -->
        <div class="d-flex flex-column flex-lg-row align-items-start align-items-lg-center justify-content-between gap-2 mb-4">
            <div class="d-flex flex-column flex-lg-row align-items-start align-items-lg-center gap-2">
                <!-- Filter buttons -->
                <div class="btn-group mb-1 mb-lg-0" role="group" aria-label="Filter group">
                    <button type="button" class="btn btn-outline-danger active" data-role="Employees">Employees</button>
                    <button type="button" class="btn btn-outline-danger" data-role="Admin">Admins</button>
                </div>
                <button class="btn btn-danger d-flex align-items-center ms-0 ms-lg-3 admin-only" data-bs-toggle="modal" data-bs-target="#addUserModal"><i class="bi bi-plus-lg me-1"></i> Add New User</button>
                <button class="btn btn-outline-secondary d-flex align-items-center ms-0 ms-lg-2 admin-only"><i class="bi bi-download me-1"></i> Export List</button>
            </div>
            <!-- Counts -->
            <div class="d-flex flex-column align-items-end ms-lg-3" style="min-width:110px;">
                <span style="font-size:0.95em; color:#888; line-height:1.1;">Total Employees: <span id="countTotal" style="font-size:1em; font-weight:600; color:#c82333;">0</span></span>
                <span style="font-size:0.95em; color:#888; line-height:1.1;">Current Active: <span id="countActive" style="font-size:1em; font-weight:600; color:#c82333;">0</span></span>
            </div>
        </div>

        <!-- Employee Table Controls -->
        <div class="d-flex justify-content-end align-items-center mb-2">
            <div class="input-group" style="max-width: 320px;">
                <span class="input-group-text bg-white border-end-0"><i class="bi bi-search text-secondary"></i></span>
                <input type="text" class="form-control border-start-0 border-end-0" placeholder="Search username..." id="userSearchInput">
                <button class="btn btn-outline-secondary border-start-0" type="button" id="sortUsersBtn"><i class="bi bi-arrow-down-up"></i></button>
            </div>
        </div>

        <!-- Employee Table -->
        <div class="table-responsive bg-white shadow-sm rounded-3 p-3">
            <table class="table align-middle mb-0">
                <thead class="table-light">
                    <tr>
                        <th scope="col">Select</th>
                        <th scope="col">Photo</th>
                        <th scope="col">Username</th>
                        <th scope="col">Email</th>
                        <th scope="col">Mobile</th>
                        <th scope="col">Role</th>
                        <th scope="col">Status</th>
                        <th scope="col" class="text-center">Operation</th>
                    </tr>
                </thead>
                <tbody id="employeeTable">
                    <tr data-role="Admin" data-status="Active">
                        <td><input type="checkbox" class="form-check-input"></td>
                        <td><img src="signup-login images/J2E logo favicon.png" class="avatar" alt="Employee" /></td>
                        <td>Admin 1</td>
                        <td>admin1@j2e.ph</td>
                        <td>+63 917 123 4567</td>
                        <td>Admin</td>
                        <td><span class="badge bg-success">Active</span></td>
                        <td class="text-center">
                            <button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="modal" data-bs-target="#editUserModal"><i class="bi bi-pencil"></i></button>
                            <button class="btn btn-sm btn-outline-danger"><i class="bi bi-trash"></i></button>
                        </td>
                    </tr>
                    <tr data-role="Employees" data-status="Active">
                        <td><input type="checkbox" class="form-check-input"></td>
                        <td><img src="signup-login images/J2E logo favicon.png" class="avatar" alt="Employee" /></td>
                        <td>Employee 2</td>
                        <td>employee2@j2e.ph</td>
                        <td>+63 943 154 8693</td>
                        <td>Employee</td>
                        <td><span class="badge bg-success">Active</span></td>
                        <td class="text-center">
                            <button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="modal" data-bs-target="#editUserModal"><i class="bi bi-pencil"></i></button>
                            <button class="btn btn-sm btn-outline-danger"><i class="bi bi-trash"></i></button>
                        </td>
                    </tr>
                    <tr data-role="Employees" data-status="Inactive">
                        <td><input type="checkbox" class="form-check-input"></td>
                        <td><img src="signup-login images/J2E logo favicon.png" class="avatar" alt="Employee" /></td>
                        <td>Employee 3</td>
                        <td>employee3@j2e.ph</td>
                        <td>+63 952 135 9344</td>
                        <td>Employee</td>
                        <td><span class="badge bg-secondary">Inactive</span></td>
                        <td class="text-center">
                            <button class="btn btn-sm btn-outline-primary me-1" data-bs-toggle="modal" data-bs-target="#editUserModal"><i class="bi bi-pencil"></i></button>
                            <button class="btn btn-sm btn-outline-danger"><i class="bi bi-trash"></i></button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Modals (Add & Edit) -->
        <!-- Add User Modal -->
        <div class="modal fade" id="addUserModal" tabindex="-1" aria-labelledby="addUserLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="addUserLabel">Add New User</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <form id="addUserForm" class="row g-3">
                            <!-- Image Upload Section -->
                            <div class="col-12 text-center mb-3">
                                <img id="addImagePreview" src="https://via.placeholder.com/150x150?text=Upload+Photo" class="image-preview mb-2" alt="Preview" />
                                <input class="form-control" type="file" id="addImage" accept="image/*" />
                            </div>
                           
                            <!-- Form Fields -->
                            <div class="col-md-6">
                                <label for="addUsername" class="form-label">Username</label>
                                <input type="text" class="form-control" id="addUsername" required />
                            </div>
                            <div class="col-md-6">
                                <label for="addEmail" class="form-label">Email</label>
                                <input type="email" class="form-control" id="addEmail" required />
                            </div>
                            <div class="col-md-6">
                                <label for="addMobile" class="form-label">Mobile Number</label>
                                <input type="tel" class="form-control" id="addMobile" placeholder="+63 XXX XXX XXXX" required />
                            </div>
                            <div class="col-md-6">
                                <label for="addRole" class="form-label">Role</label>
                                <select class="form-select" id="addRole" required>
                                    <option value="">Select Role</option>
                                    <option value="Admin">Admin</option>
                                    <option value="Employee">Employee</option>
                                </select>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button type="button" class="btn btn-danger" id="saveAddUser">Save User</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Edit User Modal -->
        <div class="modal fade" id="editUserModal" tabindex="-1" aria-labelledby="editUserLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="editUserLabel">Edit User</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <form id="editUserForm" class="row g-3">
                            <!-- Image Upload Section -->
                            <div class="col-12 text-center mb-3">
                                <img id="editImagePreview" src="https://via.placeholder.com/150x150?text=Upload+Photo" class="image-preview mb-2" alt="Preview" />
                                <input class="form-control" type="file" id="editImage" accept="image/*" />
                            </div>
                           
                            <!-- Form Fields -->
                            <div class="col-md-6">
                                <label for="editUsername" class="form-label">Username</label>
                                <input type="text" class="form-control" id="editUsername" required />
                            </div>
                            <div class="col-md-6">
                                <label for="editEmail" class="form-label">Email</label>
                                <input type="email" class="form-control" id="editEmail" required />
                            </div>
                            <div class="col-md-6">
                                <label for="editMobile" class="form-label">Mobile Number</label>
                                <input type="tel" class="form-control" id="editMobile" placeholder="+63 XXX XXX XXXX" required />
                            </div>
                            <div class="col-md-6">
                                <label for="editRole" class="form-label">Role</label>
                                <select class="form-select" id="editRole" required>
                                    <option value="">Select Role</option>
                                    <option value="Admin">Admin</option>
                                    <option value="Employee">Employee</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label for="editStatus" class="form-label">Status</label>
                                <select class="form-select" id="editStatus" required>
                                    <option value="Active">Active</option>
                                    <option value="Inactive">Inactive</option>
                                </select>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button type="button" class="btn btn-danger" id="saveEditUser">Update User</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Delete Confirmation Modal -->
        <div class="modal fade" id="deleteUserModal" tabindex="-1" aria-labelledby="deleteUserLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="deleteUserLabel">Confirm Delete</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <p>Are you sure you want to delete this user? This action cannot be undone.</p>
                        <p class="text-muted">User: <span id="deleteUserName"></span></p>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button type="button" class="btn btn-danger" id="confirmDeleteUser">Delete User</button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
   
    <script>
        // Initialize counts
        function updateCounts() {
            const visibleRows = Array.from(document.querySelectorAll('#employeeTable tr')).filter(row => row.style.display !== 'none');
            const activeRows = visibleRows.filter(row => row.getAttribute('data-status') === 'Active');
            document.getElementById('countTotal').textContent = visibleRows.length;
            document.getElementById('countActive').textContent = activeRows.length;
        }

        // Filter functionality
        document.querySelectorAll('[data-role]').forEach(button => {
            button.addEventListener('click', function() {
                const role = this.getAttribute('data-role');
               
                // Update active button
                document.querySelectorAll('[data-role]').forEach(btn => btn.classList.remove('active'));
                this.classList.add('active');
               
                // Filter table rows
                document.querySelectorAll('#employeeTable tr').forEach(row => {
                    if (role === 'All' || row.getAttribute('data-role') === role) {
                        row.style.display = '';
                    } else {
                        row.style.display = 'none';
                    }
                });
               
                updateCounts();
            });
        });

        // Image preview functionality
        function setupImagePreview(inputId, previewId) {
            const input = document.getElementById(inputId);
            const preview = document.getElementById(previewId);
           
            input.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        preview.src = e.target.result;
                    };
                    reader.readAsDataURL(file);
                }
            });
        }

        // Setup image previews
        setupImagePreview('addImage', 'addImagePreview');
        setupImagePreview('editImage', 'editImagePreview');

        // Add user functionality
        document.getElementById('saveAddUser').addEventListener('click', function() {
            const form = document.getElementById('addUserForm');
            if (form.checkValidity()) {
                // Here you would typically send data to server
                alert('User added successfully!');
                bootstrap.Modal.getInstance(document.getElementById('addUserModal')).hide();
                form.reset();
                document.getElementById('addImagePreview').src = 'https://via.placeholder.com/150x150?text=Upload+Photo';
            } else {
                form.reportValidity();
            }
        });

        // Edit user functionality
        document.getElementById('saveEditUser').addEventListener('click', function() {
            const form = document.getElementById('editUserForm');
            if (form.checkValidity()) {
                // Here you would typically send data to server
                alert('User updated successfully!');
                bootstrap.Modal.getInstance(document.getElementById('editUserModal')).hide();
            } else {
                form.reportValidity();
            }
        });

        // Delete user functionality
        document.querySelectorAll('.btn-outline-danger').forEach(button => {
            if (button.querySelector('.bi-trash')) {
                button.addEventListener('click', function() {
                    const row = this.closest('tr');
                    const username = row.cells[2].textContent;
                    document.getElementById('deleteUserName').textContent = username;
                   
                    const deleteModal = new bootstrap.Modal(document.getElementById('deleteUserModal'));
                    deleteModal.show();
                });
            }
        });

        // Confirm delete
        document.getElementById('confirmDeleteUser').addEventListener('click', function() {
            // Here you would typically send delete request to server
            alert('User deleted successfully!');
            bootstrap.Modal.getInstance(document.getElementById('deleteUserModal')).hide();
        });

        // Initialize counts on page load
        document.addEventListener('DOMContentLoaded', updateCounts);

        // Show/hide admin-only buttons based on filter
        function updateAdminButtons() {
            const activeBtn = document.querySelector('[data-role].active');
            const adminOnlyEls = document.querySelectorAll('.admin-only');
            if (activeBtn && activeBtn.getAttribute('data-role') === 'Admin') {
                adminOnlyEls.forEach(el => el.style.display = 'inline-flex');
            } else {
                adminOnlyEls.forEach(el => el.style.display = 'none');
            }
        }
        // Update on filter click
        const filterBtns = document.querySelectorAll('[data-role]');
        filterBtns.forEach(btn => {
            btn.addEventListener('click', function() {
                updateAdminButtons();
            });
        });
        document.addEventListener('DOMContentLoaded', updateAdminButtons);
    </script>
</body>
</html>









